library(data.table)
activityData <- read.csv(unz("activity.zip", "activity.csv"))
activityData
str(activityData)
save.image("~/R_Workspaces/Wide.RData")
activityData$date <- as.Date(as.character(activityData$date),"%Y-%m-%d")
str(activityData)
unique(activityData$interval)
str(activityData)
activityData <- data.table(activityData,
key=c("date"))
library(ggplot2)
stepsByDay <- activityData[,totalsteps=sum(steps, na.rm = TRUE)
,by="date"]
stepsByDay <- activityData[,j=list(totalsteps=sum(steps, na.rm = TRUE))
,by="date"]
View(stepsByDay)
plot <- ggplot(stepsByDay,
aes(totalsteps))
plot+geom_histogram()
plot+geom_histogram(color="blue")
plot+geom_histogram(fill="blue")
plot+geom_histogram(fill="blue") + theme_bw()
plot+geom_histogram(binwidth=1, fill="blue") + theme_bw()
plot+geom_histogram(binwidth=1, fill="blue") + theme_bw()
plot+geom_histogram(fill="blue", color="white") + theme_bw()
plot + geom_histogram(fill="blue", color="white") +
theme_bw() +
labs(x="Total number of steps / day", y = "count")
plot + geom_histogram(fill="blue", color="white") +
theme_bw() +
labs(x="Total number of steps / day",
y = "Count",
main = "main")
plot + geom_histogram(fill="blue", color="white") +
theme_bw() +
labs(x="Total number of steps / day",
y = "Count",
title = "Steps per day")
activityData
#Activity data as "data.table"
activityData <- data.table(activityData,
key=c("date","interval"))
stepsByInterval <- activityData[,j=list(avgsteps=mean(steps, na.rm = TRUE))
,by="interval"]
plot <- ggplot(stepsByInterval,
aes(avgsteps))
plot2 <- ggplot(stepsByInterval,
aes(avgsteps))
plot1 <- ggplot(stepsByDay,
aes(totalsteps))
plot2 <- ggplot(stepsByInterval,
aes(x = interval,
y = avgsteps))
plot2 + geom_line()
plot2 + geom_line(color="blue")
plot2 + geom_line(color="blue") +
theme_bw()
plot2 + geom_line(color="blue") +
theme_bw()
labs(x="5 minutes Interval",
y = "Average number of steps",
title = "Average number of steps taken \nby 5 minutes interval")
plot2 + geom_line(color="blue") +
theme_bw() +
labs(x="5 minutes Interval",
y = "Average number of steps",
title = "Average number of steps taken \nby 5 minutes interval")
plot2 + geom_line(color="blue") +
theme_bw() +
labs(x="5 minutes Interval",
y = "Average number of steps taken",
title = "Average number of steps taken \nby 5 minutes interval")
plot2 + geom_line(color="blue") +
theme_bw() +
labs(x="5 minutes Interval",
y = "Average number of steps taken",
title = "Average number of steps taken by 5 minutes interval \n averaged across all days")
which.max(stepsByInterval$avgsteps)
stepsByInterval$interval[which.max(stepsByInterval$avgsteps)]
is.na(activityData)
sum(is.na(activityData$steps))
sum(is.na(activityData$date))
sum(is.na(activityData$interval))
length(unique(activityData$date))
weekdays(activityData)
weekdays(activityData$date)
activityData$weekday <- weekdays(activityData$date)
str(activityData)
setkey(activityData,c("interval",
"date",
"weekday"))
setkey(activityData,c(date,
interval,
weekday))
setkey(activityData,list(date,
interval,
weekday))
activityData <- read.csv(unz("activity.zip", "activity.csv"))
activityData$date <- as.Date(as.character(activityData$date),"%Y-%m-%d")
activityData$weekday <- weekdays(activityData$date)
activityData <- data.table(activityData,
key=c("date","interval","weekday"))
stepsByDay <- activityData[,j=list(totalsteps=sum(steps, na.rm = TRUE))
,by="date"]
#Histogram:
plot1 <- ggplot(stepsByDay,
aes(totalsteps))
plot1 + geom_histogram(fill="blue", color="white") +
theme_bw() +
labs(x="Total number of steps / day",
y = "Count",
title = "Total number of steps taken per day")
#Aggregating steps by interval
stepsByInterval <- activityData[,j=list(avgsteps=mean(steps, na.rm = TRUE))
,by="interval"]
#Histogram:
plot2 <- ggplot(stepsByInterval,
aes(x = interval,
y = avgsteps))
plot2 + geom_line(color="blue") +
theme_bw() +
labs(x="5 minutes Interval",
y = "Average number of steps taken",
title = "Average number of steps taken by 5 minutes interval \n averaged across all days")
stepsbyweekdayinterval <- activityData[,j=list(avgsteps=mean(steps, na.rm = TRUE),
by=c("interval","weekday")]
stepsbyweekdayinterval <- activityData[,j=list(avgsteps=mean(steps, na.rm = TRUE)),
by=c("interval","weekday")]
head(stepsbyweekdayinterval)
#Average steps by weekday, interval
stepsbyweekdayinterval <- activityData[,j=list(avgsteps=mean(steps, na.rm = TRUE)),
by=c("weekday","interval")]
head(stepsbyweekdayinterval)
stepsbyweekdayinterval
methods(generic.function="merge")
str(stepsbyweekdayinterval)
stepsbyweekdayinterval <- activityData[,j=list(avgstepsfill=mean(steps, na.rm = TRUE)),
by=c("weekday","interval")]
activityDataNoMissing <- merge.data.table(x=activityData,
y=stepsbyweekdayinterval,
by=c("weekday", "interval"),
all.x = TRUE)
activityDataNoMissing <- merge(x=activityData,
y=stepsbyweekdayinterval,
by=c("weekday", "interval"),
all.x = TRUE)
activityDataNoMissing
activityDataNoMissing$steps[is.na(activityDataNoMissing$steps),] <- activityDataNoMissing$avgstepsfill[is.na(activityDataNoMissing$steps),]
activityDataNoMissing$steps[is.na(activityDataNoMissing$steps)] <- activityDataNoMissing$avgstepsfill[is.na(activityDataNoMissing$steps)]
sum(is.na(activityDataNoMissing$steps))
str(activityDataNoMissing)
activityDataNoMissing <- data.table(activityDataNoMissing[,2:4, width=FALSE],
key = c("date", "interval"))
activityDataNoMissing <- data.table(activityDataNoMissing[,.(2:4)],
key = c("date", "interval"))
activityDataNoMissing[,.(2:4)]
activityDataNoMissing <- data.table(activityDataNoMissing[,2:4,with=FALSE],
key = c("date", "interval"))
str(activityDataNoMissing)
sum(is.na(activityDataNoMissing$steps))
rm(activityDataNoMissing)
activityDataNN <- merge(x=activityData,
y=stepsbyweekdayinterval,
by=c("weekday", "interval"),
all.x = TRUE)
activityDataNN$steps[is.na(activityDataNN$steps)] <- activityDataNN$avgstepsfill[is.na(activityDataNN$steps)]
activityDataNoMissing <- data.table(activityDataNoMissing[,2:4,with=FALSE],
key = c("date", "interval"))
activityDataNoMissing <- data.table(activityDataNN[,2:4,with=FALSE],
key = c("date", "interval"))
rm(activityDataNoMissing)
activityDataNN <- data.table(activityDataNN[,2:4,with=FALSE],
key = c("date", "interval"))
stepsByDayNN <- activityDataNN[,j=list(totalsteps=sum(steps, na.rm = TRUE))
,by="date"]
#Histogram:
plot1 <- ggplot(stepsByDayNN,
aes(totalsteps))
plot1 + geom_histogram(fill="blue", color="white") +
theme_bw() +
labs(x="Total number of steps / day",
y = "Count",
title = "Total number of steps taken per day")
